@startuml
interface RollerPermission {
  +implies(RollerPermission): boolean
  +getActions(): String
}
class GlobalPermission {
  -actions: List<String>
  +implies(RollerPermission): boolean
}
class WeblogPermission {
  -weblog: Weblog
  -actions: List<String>
  +getWeblog(): Weblog
  +hasAction(String): boolean
}
class ObjectPermission {
  -id: String
  -user: User
  -objectId: String
  -objectType: String
  -pending: boolean
  -dateCreated: Date
  +getUser(): User
  +getObjectId(): String
  +isPending(): boolean
}
class UserRole {
  -id: String
  -userName: String
  -role: String
  +getUserName(): String
  +getRole(): String
}
class User {
  -id: String
  -userName: String
  -password: String
  -screenName: String
  -fullName: String
  -emailAddress: String
  -dateCreated: Date
  -locale: String
  -timeZone: String
  -enabled: boolean
  +getUserName(): String
  +getEmailAddress(): String
  +hasRole(String): boolean
  +getPermissions(): List<ObjectPermission>
}
interface UserManager {
  +addUser(User): void
  +saveUser(User): void
  +removeUser(User): void
  +getUser(String): User
  +getUserByUserName(String): User
  +getUserByEmail(String): User
  +getUsers(int, int): List<User>
  +getUserCount(): int
  +grantRole(String, User): void
  +revokeRole(String, User): void
  +getPermissions(User): List<ObjectPermission>
  +grantWeblogPermission(Weblog, User, List<String>): void
  +revokeWeblogPermission(Weblog, User, List<String>): void
  +getWeblogPermission(Weblog, User): WeblogPermission
}
class JPAUserManagerImpl {
  -strategy: JPAPersistenceStrategy
  +addUser(User): void
  +saveUser(User): void
  +removeUser(User): void
  +getUser(String): User
  +getUserByUserName(String): User
  +getUserByEmail(String): User
  +getUsers(int, int): List<User>
  +getUserCount(): int
  +grantRole(String, User): void
  +revokeRole(String, User): void
  +getPermissions(User): List<ObjectPermission>
  +executeNamedQuery(String, Object...): List
}
class Weblogger {
  +getUserManager(): UserManager
  +getWeblogManager(): WeblogManager
  +flush(): void
  +release(): void
  +shutdown(): void
}
class WebloggerFactory {
  -weblogger: Weblogger
  +getWeblogger(): Weblogger
  +bootstrap(): void
}
class UserBean {
  +userName: String
  +emailAddress: String
  +screenName: String
  +fullName: String
  +password: String
  +locale: String
  +timeZone: String
  +copyFrom(User): void
  +copyTo(User): void
}
abstract class UIAction {
  #actionName: String
  #actionWeblog: Weblog
  #authenticatedUser: User
  +execute(): String
  +getAuthenticatedUser(): User
}
class UserAdmin {
  -userList: List<User>
  -searchCriteria: String
  -page: int
  -userManager: UserManager
  +execute(): String
  +search(): String
  +enableUser(): String
  +disableUser(): String
  +getUserList(): List<User>
}
class Register {
  -bean: UserBean
  -userManager: UserManager
  +execute(): String
  +save(): String
  +validateRegistration(): void
  +createUser(): User
}
class UserEdit {
  -userId: String
  -userBeingEdited: User
  -bean: UserBean
  -userManager: UserManager
  +execute(): String
  +save(): String
  +getUserBeingEdited(): User
  +validateUser(): void
}
class Profile {
  -bean: UserBean
  -userManager: UserManager
  +execute(): String
  +save(): String
  +changePassword(): String
  +validateProfile(): void
}
RollerPermission <|.. GlobalPermission
RollerPermission <|.. WeblogPermission
ObjectPermission *-- WeblogPermission
User "1" -- "0..*" UserRole : has
User "1" -- "0..*" ObjectPermission : grants
ObjectPermission "1" -- "1" User
JPAUserManagerImpl ..|> UserManager
JPAUserManagerImpl --> User : manages
JPAUserManagerImpl --> UserRole : manages
JPAUserManagerImpl --> ObjectPermission : manages
Weblogger *-- UserManager : contains
WebloggerFactory ..> Weblogger : creates
UIAction <|-- UserAdmin
UIAction <|-- Register
UIAction <|-- UserEdit
UIAction <|-- Profile
UserAdmin --> UserManager : uses
Register --> UserManager : uses
UserEdit --> UserManager : uses
Profile --> UserManager : uses
Register --> UserBean : uses
UserEdit --> UserBean : uses
Profile --> UserBean : uses
UserBean ..> User : transfers data
@enduml
